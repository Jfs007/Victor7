!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.vicApp=t():e.vicApp=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{changeOptions:()=>h,changeQuery:()=>c,query:()=>u,use:()=>p,vic:()=>r});const n=function(e,t){let n={};return t.map((t=>{n[t]=e[t]})),n},i={query:function(e){let t=e.match(/.*(\?.*)/);t&&(e=t[1]);let n={};return e.replace(/(\w+)=?([^=&]+)?&?/g,(function(e,t,i){n[t]=i?i.trim():""})),n},toSearch:function(e){let t="";return Object.keys(e).map((n=>{let i=e[n];t+=`${t?"&":"?"}${n}=${i}`})),t}},s=class{app=null;constructor(e,t){this.console=new class{constructor(){}log(e){console.log("[32m",e)}error(e){return console.log(new Error(e))}warn(e){console.log("[33m",e)}}}init(e={}){for(let t in e)this[t]=e[t]}setup(){}},o=class extends s{_name="navigate";app=null;pointer=null;alias="$n";delta=-1;define={};Url=i;query={};constructor(){super()}setup(e){let t=this;return this.app=e,this.define=n(this.app,["switchTab","reLaunch","redirectTo","navigateTo","navigateBack"]),this.define.navigateBaseTo=this.navigateBaseTo,Object.keys(this.define).map((e=>{Object.defineProperty(this.app,e,{get:function(){return t[e].bind(t)}})})),this}setQuery(e){let{url:t}=e;this.query=i.query(t)}switchTab(e={}){this.setQuery(e),this.define.switchTab.call(this.app,e)}reLaunch(e={}){this.setQuery(e),this.define.reLaunch.call(this.app,e)}redirectTo(e={}){this.setQuery(e),this.define.redirectTo.call(this.app,e)}navigateTo(e={}){this.setQuery(e),this.define.navigateTo.call(this.app,e)}navigateBack(e={}){let{delta:t,url:n}=e;"base"==t&&this.pointer?(e.delta=this.getDelta(),this.base()):e.delta=t||1,this.setQuery({url:n||""}),this.define.navigateBack.call(this.app,e)}navigateBaseTo(e){let t=getCurrentPages();this.pointer=t[t.length-1],this.delta=t.length,this.navigateTo(e)}base(){this.pointer=null,this.delta=-1}getDelta(){let e=this.pointer,t=this.delta;return e?getCurrentPages().length-t:-1}},a=class extends s{_name="auth";key="vic-auth";alias="$a";userInfo={token:void 0};constructor(e){super(),this.userInfo.token=this.getToken()}updateUserInfo(e={}){Object.keys(e).map((t=>{let n=e[t];this.userInfo[t]=n}))}setup(e={}){this.init(e)}login(){}logout(){this.updateUserInfo({token:""}),this.removeToken()}setToken(e){((e,t)=>{try{wx.setStorageSync(e,t)}catch(e){}})(this.key,e)}removeToken(){(e=>{try{wx.removeStorage({key:e})}catch(e){}})(this.key)}getToken(){return e=this.key,wx.getStorageSync(e);var e}};let r=new class{name="vic";env=null;constructor(){}setup(e){this.app=e,this.app[this.name]=this,this.load(o).setup(this.app),this.load(a)}use(e,t){this[e]=t}load(e){let t=new e;return this[t.alias]=t,this[t._name]=t,t}};function l(){var e=getCurrentPages();return e[e.length-1]}function u(e={}){let t=(e.context?e.context:l()||{}).options||{};return Object.assign({},t,r.navigate.query||{})}function c(e={}){let t=l();r.navigate.query=Object.assign(u(),e||{}),t&&t.options&&(t.options=r.navigate.query)}function h(e){let t=l();t&&t.options&&(t.options=e)}function p(e,t){r.use(e,t)}return console.log(r,"vic"),t})()));